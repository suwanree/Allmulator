<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Linked List Visualizer</title>
    <style>
        /* ì „ì²´ ë ˆì´ì•„ì›ƒ */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 50px;
        }

        h1 { color: #333; }

        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ ë””ìì¸ */
        .controls {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 40px;
            display: flex;
            gap: 10px;
        }

        input {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            width: 80px;
        }

        button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s;
            font-weight: bold;
        }

        button:hover { background-color: #0056b3; }
        button.delete { background-color: #dc3545; }
        button.delete:hover { background-color: #a71d2a; }

        /* --- ì‹œê°í™” ì˜ì—­ í•µì‹¬ CSS --- */
        #visualizer {
            display: flex; /* ê°€ë¡œë¡œ ë°°ì¹˜ */
            align-items: center; /* ìˆ˜ì§ ì¤‘ì•™ ì •ë ¬ */
            flex-wrap: wrap; /* ë„ˆë¬´ ê¸¸ì–´ì§€ë©´ ì¤„ë°”ê¿ˆ */
            gap: 10px;
            min-height: 150px;
            padding: 20px;
            width: 100%;
            justify-content: center;
        }

        /* ê°œë³„ ë…¸ë“œ ë””ìì¸ */
        .node-wrapper {
            display: flex;
            align-items: center;
            animation: fadeIn 0.5s ease-out; /* ë“±ì¥ ì• ë‹ˆë©”ì´ì…˜ */
        }

        .node {
            width: 60px;
            height: 60px;
            background: linear-gradient(145deg, #ffffff, #e6e6e6);
            border: 2px solid #333;
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            font-weight: bold;
            color: #333;
            box-shadow: 5px 5px 10px #d1d1d1, -5px -5px 10px #ffffff;
            position: relative;
        }

        /* ë©”ëª¨ë¦¬ ì£¼ì†Œ (ì¥ì‹ìš©) */
        .address {
            position: absolute;
            top: -20px;
            font-size: 10px;
            color: #888;
            font-family: monospace;
        }

        /* í™”ì‚´í‘œ ë””ìì¸ */
        .arrow {
            font-size: 24px;
            color: #555;
            margin: 0 10px;
        }

        /* Null í¬ì¸í„° ë””ìì¸ */
        .null-node {
            font-size: 14px;
            font-weight: bold;
            color: #dc3545;
            border: 2px dashed #dc3545;
            padding: 10px;
            border-radius: 6px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

    <h1>ğŸš€ C++ Linked List Visualization</h1>

    <div class="controls">
        <input type="number" id="inputValue" placeholder="ê°’" value="10">
        <input type="number" id="inputPos" placeholder="ìœ„ì¹˜" value="1">
        <button onclick="insertNode()">Insert</button>
        <button class="delete" onclick="deleteNode()">Delete</button>
    </div>

    <div id="visualizer">
        <div style="color: #aaa;">Loading WebAssembly...</div>
    </div>

    <script src="linkedlist.js"></script>
    <script>
        let listInstance = null;

        Module.onRuntimeInitialized = function() {
            listInstance = new Module.Linkedlist();
            renderList();
        };

        function insertNode() {
            if (!listInstance) return;
            const val = parseInt(document.getElementById('inputValue').value);
            const pos = parseInt(document.getElementById('inputPos').value);
            if(isNaN(val) || isNaN(pos)) return alert("ê°’ê³¼ ìœ„ì¹˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”");

            listInstance.insert(val, pos);
            renderList();
        }

        function deleteNode() {
            if (!listInstance) return;
            const pos = parseInt(document.getElementById('inputPos').value);
            listInstance.erase_by_pos(pos);
            renderList();
        }

        // --- í•µì‹¬: ë°ì´í„°ë¥¼ ê·¸ë˜í”½ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜ ---
        function renderList() {
            if (!listInstance) return;

            const container = document.getElementById('visualizer');
            container.innerHTML = ''; // í™”ë©´ ì´ˆê¸°í™”

            const cppVector = listInstance.get_all_elements();
            const size = cppVector.size();

            // 1. ë…¸ë“œê°€ í•˜ë‚˜ë„ ì—†ì„ ë•Œ
            if (size === 0) {
                container.innerHTML = '<div class="null-node">Head -> nullptr</div>';
                cppVector.delete();
                return;
            }

            // 2. Head í‘œì‹œ
            container.innerHTML += '<div class="arrow" style="font-size:14px">Head</div><div class="arrow">â†’</div>';

            // 3. ë²¡í„°ë¥¼ ìˆœíšŒí•˜ë©° HTML ìš”ì†Œ ìƒì„±
            for (let i = 0; i < size; i++) {
                const value = cppVector.get(i);
                
                // ë…¸ë“œì™€ í™”ì‚´í‘œë¥¼ ê°ì‹¸ëŠ” ë˜í¼ ìƒì„±
                const wrapper = document.createElement('div');
                wrapper.className = 'node-wrapper';

                // ê°€ì§œ ë©”ëª¨ë¦¬ ì£¼ì†Œ ìƒì„± (ê·¸ëŸ´ì‹¸í•´ ë³´ì´ê²Œ)
                const fakeAddress = `0x${(1000 + i * 8).toString(16).toUpperCase()}`;

                wrapper.innerHTML = `
                    <div class="node">
                        <span class="address">${fakeAddress}</span>
                        ${value}
                    </div>
                    <div class="arrow">â†’</div>
                `;

                container.appendChild(wrapper);
            }

            // 4. ë§ˆì§€ë§‰ nullptr ì¶”ê°€
            container.innerHTML += '<div class="null-node">nullptr</div>';
            
            cppVector.delete(); // ë©”ëª¨ë¦¬ í•´ì œ
        }
    </script>
</body>
</html>